<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
    <title>SecProNexus | Thread</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/thread.css') }}">
    <script src="{{ url_for('static', filename='JavaScript/thread.js') }}" defer></script>
    <script src="{{ url_for('static', filename='JavaScript/backgrounds.js') }}" defer></script>
    <script>
      // サーバから注入（JSが利用）
      window.THREAD_ID = {{ thread_id|tojson }};
      window.CURRENT_USER_ID = {{ current_user_id|tojson }};
      window.IS_LOGGED_IN = {{ is_logged_in|tojson }};
    </script>
  </head>
  <body>
    <div id="particle-canvas"></div>
    <header>
      <h1 class="header-button"><a href="{{ url_for('index') }}">SecProNexus</a></h1>
      <h2>Thread #{{ thread_id }}</h2>
    </header>

    <main>
      <section id="postList" class="post-list" aria-live="polite"></section>

      <nav class="toolbar">
        <button id="olderBtn" type="button">さらに読み込む</button>
      </nav>
    </main>

    <footer class="composer">
      {% if is_logged_in %}
        <form id="composerForm" enctype="multipart/form-data">
          <div class="row">
            <textarea id="content" name="content" placeholder="メッセージを入力…" maxlength="4000"></textarea>
          </div>
          <div class="row">
            <input type="file" id="file" name="file">
            <input type="url" id="media_url" name="media_url" placeholder="MediaのURL（任意）" style="flex:1">
            <div><button id="sendBtn" type="submit">送信</button></div>
          </div>
        </form>
        <center><h4>&copy; セキプロ2023年度入学生部員. All rights reserved.</h4></center>
      {% else %}
        <p class="muted">投稿するにはログインしてください。</p>
        <center><h4>&copy; セキプロ2023年度入学生部員. All rights reserved.</h4></center>
      {% endif %}
    </footer>
  </body>
  <script>
    document.addEventListener('contextmenu', e => {
      if (e.target.tagName === 'VIDEO' || e.target.tagName === 'AUDIO' || e.target.tagName === 'IMG') {
        e.preventDefault();
      }
    });
  </script>
</html>
